<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>m3u8 Stream Player</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }
        video {
            width: 80%;
            max-width: 800px;
            margin-top: 20px;
            border: 2px solid #333;
        }
        .controls {
            margin-top: 10px;
        }
        .controls button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>m3u8 Stream Player</h1>
    <video id="videoPlayer" controls autoplay></video>
    <div class="controls">
        <button onclick="changeChannel('mjh-channel-9-vic')">Channel 9</button>
        <button onclick="changeChannel('mjh-gem-vic')">GEM</button>
        <button onclick="changeChannel('mjh-go-vic')">GO</button>
        <button onclick="changeChannel('mjh-life-vic')">LIFE</button>
        <button onclick="changeChannel('mjh-rush-vic')">RUSH</button>
    </div>

    <!-- Include HLS.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        const videoPlayer = document.getElementById('videoPlayer');

        function changeChannel(channelKey) {
            // Retrieve the stored m3u8 files from localStorage
            const m3u8Files = JSON.parse(localStorage.getItem('m3u8Files'));

            if (m3u8Files && m3u8Files[channelKey]) {
                const blob = new Blob([m3u8Files[channelKey]], { type: 'application/vnd.apple.mpegurl' });
                const url = URL.createObjectURL(blob);

                if (Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(url);
                    hls.attachMedia(videoPlayer);
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        videoPlayer.play();
                    });
                } else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                    // For Safari, which natively supports HLS
                    videoPlayer.src = url;
                    videoPlayer.play();
                } else {
                    alert('Your browser does not support HLS.js or native HLS playback.');
                }
            } else {
                alert('Channel not available or m3u8 data is missing.');
            }
        }

        // Automatically load the first channel on page load
        window.onload = () => {
            changeChannel('mjh-channel-9-vic');
        };
    </script>
</body>
</html>
